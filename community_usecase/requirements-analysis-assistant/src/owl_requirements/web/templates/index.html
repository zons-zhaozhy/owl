<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>需求分析助手</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/vue@3.2.31"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body class="bg-gray-100">
    <div id="app" class="container mx-auto px-4 py-8">
        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-800">需求分析助手</h1>
            <p class="text-gray-600 mt-2">基于OWL框架的智能需求分析系统</p>
        </header>

        <main class="bg-white rounded-lg shadow-lg p-6">
            <!-- 输入表单 -->
            <div class="mb-8">
                <h2 class="text-2xl font-semibold mb-4">需求输入</h2>
                <div class="space-y-4">
                    <div>
                        <label class="block text-gray-700 mb-2" for="projectName">项目名称</label>
                        <input type="text" id="projectName" v-model="input.projectName"
                            class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                            placeholder="请输入项目名称">
                    </div>
                    <div>
                        <label class="block text-gray-700 mb-2" for="description">项目描述</label>
                        <input type="text" id="description" v-model="input.description"
                            class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                            placeholder="请输入项目描述">
                    </div>
                    <div>
                        <label class="block text-gray-700 mb-2" for="requirements">需求描述</label>
                        <textarea id="requirements" v-model="input.text"
                            class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                            rows="6" placeholder="请输入需求描述"></textarea>
                    </div>
                    <button @click="analyzeRequirements"
                        class="w-full bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500"
                        :disabled="loading">
                        {{ loading ? '分析中...' : '开始分析' }}
                    </button>
                </div>
            </div>

            <!-- 分析结果 -->
            <div v-if="result" class="space-y-8">
                <!-- 需求列表 -->
                <div class="border-t pt-8">
                    <h2 class="text-2xl font-semibold mb-4">需求列表</h2>
                    <div class="space-y-4">
                        <div v-if="result.requirements.functional">
                            <h3 class="text-xl font-medium mb-2">功能需求</h3>
                            <div class="space-y-2">
                                <div v-for="req in result.requirements.functional" :key="req.id"
                                    class="p-4 bg-gray-50 rounded-lg">
                                    <div class="font-medium">{{ req.title }}</div>
                                    <div class="text-gray-600">{{ req.description }}</div>
                                </div>
                            </div>
                        </div>
                        <div v-if="result.requirements.non_functional">
                            <h3 class="text-xl font-medium mb-2">非功能需求</h3>
                            <div class="space-y-2">
                                <div v-for="req in result.requirements.non_functional" :key="req.id"
                                    class="p-4 bg-gray-50 rounded-lg">
                                    <div class="font-medium">{{ req.title }}</div>
                                    <div class="text-gray-600">{{ req.description }}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 分析结果 -->
                <div class="border-t pt-8">
                    <h2 class="text-2xl font-semibold mb-4">分析结果</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="p-4 bg-gray-50 rounded-lg">
                            <div class="font-medium mb-2">可行性评分</div>
                            <div class="text-2xl font-bold text-blue-500">
                                {{ Math.round(result.analysis.feasibility * 100) }}%
                            </div>
                        </div>
                        <div class="p-4 bg-gray-50 rounded-lg">
                            <div class="font-medium mb-2">复杂度评分</div>
                            <div class="text-2xl font-bold text-blue-500">
                                {{ Math.round(result.analysis.complexity * 100) }}%
                            </div>
                        </div>
                    </div>
                    <div class="mt-4">
                        <h3 class="text-xl font-medium mb-2">风险评估</h3>
                        <div class="space-y-2">
                            <div v-if="result.analysis.risks.technical">
                                <div class="font-medium">技术风险</div>
                                <ul class="list-disc list-inside text-gray-600">
                                    <li v-for="risk in result.analysis.risks.technical" :key="risk">{{ risk }}</li>
                                </ul>
                            </div>
                            <div v-if="result.analysis.risks.business">
                                <div class="font-medium">业务风险</div>
                                <ul class="list-disc list-inside text-gray-600">
                                    <li v-for="risk in result.analysis.risks.business" :key="risk">{{ risk }}</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 质量检查 -->
                <div class="border-t pt-8">
                    <h2 class="text-2xl font-semibold mb-4">质量检查</h2>
                    <div class="space-y-4">
                        <div class="p-4 bg-gray-50 rounded-lg">
                            <div class="font-medium mb-2">总体质量评分</div>
                            <div class="text-2xl font-bold text-blue-500">
                                {{ Math.round(result.quality_check.overall_score * 100) }}%
                            </div>
                        </div>
                        <div>
                            <h3 class="text-xl font-medium mb-2">改进建议</h3>
                            <ul class="list-disc list-inside text-gray-600">
                                <li v-for="suggestion in result.quality_check.improvements" :key="suggestion">
                                    {{ suggestion }}
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- 文档预览 -->
                <div class="border-t pt-8">
                    <h2 class="text-2xl font-semibold mb-4">文档预览</h2>
                    <div class="space-y-4">
                        <div v-for="section in result.documentation.sections" :key="section.title"
                            class="p-4 bg-gray-50 rounded-lg">
                            <div class="font-medium mb-2">{{ section.title }}</div>
                            <div class="text-gray-600">{{ section.content }}</div>
                            <div v-if="section.subsections" class="mt-4 space-y-2">
                                <div v-for="subsection in section.subsections" :key="subsection.title"
                                    class="ml-4">
                                    <div class="font-medium">{{ subsection.title }}</div>
                                    <div class="text-gray-600">{{ subsection.content }}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        const { createApp } = Vue

        createApp({
            data() {
                return {
                    input: {
                        projectName: '',
                        description: '',
                        text: ''
                    },
                    result: null,
                    loading: false,
                    error: null
                }
            },
            methods: {
                async analyzeRequirements() {
                    this.loading = true
                    this.error = null
                    try {
                        const response = await axios.post('/analyze', this.input)
                        this.result = response.data
                    } catch (error) {
                        this.error = error.response?.data?.detail || '分析失败，请重试'
                        alert(this.error)
                    } finally {
                        this.loading = false
                    }
                }
            }
        }).mount('#app')
    </script>
</body>
</html> 